Heavily a work in progress, please do not use until ready.
